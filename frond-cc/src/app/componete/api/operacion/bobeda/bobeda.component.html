<div class="container mt-4 cuerpo">
    <div class="row align-items-center">
        <div class="col">
            <mat-form-field>
                <input matInput (keyup)="applyFilter($event)" placeholder="Buscar">
            </mat-form-field>
        </div>
        <div class="col" style="text-align: right;">
            <button class="btn btn-primary mt-3" (click)="abrirwill()">Agregar Movimiento</button>

        </div>


    </div>
    <div class="table-responsive">

        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
            <!-- Columna Usuario -->
            <ng-container matColumnDef="Sucursal">
                <th mat-header-cell *matHeaderCellDef> Sucursal </th>
                <td mat-cell *matCellDef="let row"> {{row.nombre_sucursal}} </td>
            </ng-container>
            <ng-container matColumnDef="Divisa">
                <th mat-header-cell *matHeaderCellDef> Divisa </th>
                <td mat-cell *matCellDef="let row"> {{row.grupo}} </td>
            </ng-container>
            <ng-container matColumnDef="Entrada">
                <th mat-header-cell *matHeaderCellDef>Entrada </th>
                <td mat-cell *matCellDef="let row"> {{row.saldo}} </td>
            </ng-container>
            <ng-container matColumnDef="Salida">
                <th mat-header-cell *matHeaderCellDef> Salida </th>
                <td mat-cell *matCellDef="let row"> {{row.salida}} </td>
            </ng-container>
            <ng-container matColumnDef="Descripcion">
                <th mat-header-cell *matHeaderCellDef> Descripcion </th>
                <td mat-cell *matCellDef="let row"> {{row.descripcion}} </td>
            </ng-container>


            <!-- Columna Acciones -->
            <!--<ng-container matColumnDef="acciones">
                <th mat-header-cell *matHeaderCellDef> Acciones </th>
                <td mat-cell *matCellDef="let row">
                    <button mat-icon-button color="primary" (click)="abrirwill2(row)">
                        <mat-icon>edit</mat-icon>
                    </button>
                    
                </td>
            </ng-container>-->

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>

        <mat-paginator *ngIf="!activar" [pageSizeOptions]="[5, 10, 25, 50]" showFirstLastButtons></mat-paginator>
    </div>

</div>

<div class="modal fade" bsModal #will="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
<div class="modal-dialog modal-lg modal-dialog-centered">
  <div class="modal-content shadow-lg border-0 rounded-3">
    <div class="modal-header bg-primary text-white">
      <h4 class="modal-title mb-0">
        <i class="bi bi-cash-coin me-2"></i>
        {{ info ? 'Agregar Movimiento' : 'Detalle de Movimiento' }}
      </h4>
      <button type="button" class="btn-close btn-close-white" (click)="will.hide()"></button>
    </div>

    <div class="modal-body">
      <form class="form-responsive needs-validation" novalidate>
        <div class="card border-0 shadow-sm mb-4">
          <div class="card-header bg-light fw-semibold">
            <i class="bi bi-arrow-left-right me-2"></i> Entradas y Salidas de Sucursal
          </div>
          <div class="card-body">
            <!-- Sucursal y Divisa -->
            <div class="row g-3 align-items-end">
              <div class="col-md-6" *ngIf="sinsucursal == true">
                <label for="sucursalid" class="form-label">Sucursal</label>
                <select
                  class="form-select"
                  id="sucursalid"
                  [(ngModel)]="idsucursalid"
                  [ngModelOptions]="{ standalone: true }"
                  required
                >
                  <option value="">Seleccione una sucursal</option>
                  <option *ngFor="let dat of sucursales" [value]="dat.sucursalid">
                    {{ dat.nombre_sucursal }}
                  </option>
                </select>
              </div>

              <div class="col-md-6">
                <label for="grupodivisa" class="form-label">Divisa</label>
                <select
                  class="form-select"
                  id="grupodivisa"
                  [(ngModel)]="idgrupodivisa"
                  [ngModelOptions]="{ standalone: true }"
                  required
                >
                  <option value="">Seleccione una divisa</option>
                  <option *ngFor="let dat of grupodivisa" [value]="dat.idgrupo">
                    {{ dat.grupo }}
                  </option>
                </select>
              </div>
            </div>

            <hr class="my-4" />

            <!-- Tipo de movimiento -->
            <div class="form-check form-switch mb-3">
              <input
                class="form-check-input"
                type="checkbox"
                id="tipoMovimiento"
                [checked]="isChecked"
                (change)="isChecked = !isChecked"
              />
              <label class="form-check-label fw-semibold" for="tipoMovimiento">
                Tipo de movimiento: {{ isChecked ? 'Entrada' : 'Salida' }}
              </label>
            </div>

            <!-- Entrada y salida -->
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Entrada</label>
                <input
                  type="number"
                  class="form-control"
                  placeholder="0.00"
                  [(ngModel)]="entrada"
                  [ngModelOptions]="{ standalone: true }"
                  [disabled]="!isChecked"
                />
              </div>
              <div class="col-md-6">
                <label class="form-label">Salida</label>
                <input
                  type="number"
                  class="form-control"
                  placeholder="0.00"
                  [(ngModel)]="salida"
                  [ngModelOptions]="{ standalone: true }"
                  [disabled]="isChecked"
                />
              </div>
            </div>

            <!-- Descripción -->
            <div class="mt-4">
              <label class="form-label">Descripción</label>
              <textarea
                class="form-control"
                rows="2"
                placeholder="Motivo o detalle del movimiento"
                [(ngModel)]="descripcion"
                [ngModelOptions]="{ standalone: true }"
              ></textarea>
            </div>
          </div>
        </div>
      </form>

      <!-- Botones -->
      <div class="d-flex justify-content-between mt-3">
        <button
          class="btn btn-primary px-4"
          *ngIf="info == true"
          (click)="guardarmovimiento()"
        >
          <i class="bi bi-save me-1"></i> Guardar
        </button>
        <button class="btn btn-outline-secondary px-4" (click)="will.hide()">
          <i class="bi bi-x-circle me-1"></i> Cerrar
        </button>
      </div>
    </div>
  </div>
</div>

</div>